<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–•–∞–º–µ—Å—Ç–µ—Ä –ö–æ–º–±–∞—Ç</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary: #FF6B35;
            --secondary: #4ECDC4;
            --dark: #292F36;
            --light: #F7FFF7;
            --danger: #FF6B6B;
            --success: #06D6A0;
            --warning: #FFD166;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            padding: 10px;
        }

        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Header Styles */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background: rgba(41, 47, 54, 0.8);
            border-radius: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .player-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .player-avatar {
            width: 50px;
            height: 50px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .player-stats {
            display: flex;
            flex-direction: column;
        }

        .player-name {
            font-weight: bold;
            font-size: 16px;
        }

        .player-level {
            font-size: 14px;
            color: var(--secondary);
        }

        .currency-display {
            display: flex;
            gap: 10px;
        }

        .currency {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
        }

        /* Button Styles */
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 16px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-large {
            padding: 15px 25px;
            font-size: 18px;
            width: 100%;
            margin-bottom: 15px;
        }

        /* Menu Styles */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .menu-card {
            background: rgba(41, 47, 54, 0.8);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .menu-card:hover {
            transform: translateY(-5px);
            background: rgba(41, 47, 54, 0.9);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .menu-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        /* Battle Screen Styles */
        .battle-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .battle-field {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 200px;
            background: rgba(41, 47, 54, 0.6);
            border-radius: 15px;
            padding: 20px;
            position: relative;
        }

        .character {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .character-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .player-character {
            background: rgba(255, 107, 53, 0.2);
        }

        .enemy-character {
            background: rgba(255, 107, 107, 0.2);
        }

        .health-bar {
            width: 100px;
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            overflow: hidden;
        }

        .health-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.5s ease;
        }

        .enemy-health-fill {
            background: var(--danger);
        }

        .battle-log {
            height: 150px;
            background: rgba(41, 47, 54, 0.8);
            border-radius: 10px;
            padding: 10px;
            overflow-y: auto;
            font-size: 14px;
        }

        .battle-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .action-btn {
            padding: 15px 10px;
            border: none;
            border-radius: 10px;
            background: rgba(41, 47, 54, 0.8);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .action-btn:hover {
            background: rgba(41, 47, 54, 1);
            transform: translateY(-3px);
        }

        /* Shop Styles */
        .shop-categories {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .category-btn {
            padding: 10px 15px;
            background: rgba(41, 47, 54, 0.8);
            border: none;
            border-radius: 20px;
            color: white;
            cursor: pointer;
            white-space: nowrap;
        }

        .category-btn.active {
            background: var(--primary);
        }

        .shop-items {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .shop-item {
            background: rgba(41, 47, 54, 0.8);
            border-radius: 15px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .item-icon {
            font-size: 30px;
        }

        .item-rarity {
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 12px;
        }

        .rarity-common {
            background: #95a5a6;
        }

        .rarity-rare {
            background: #3498db;
        }

        .rarity-epic {
            background: #9b59b6;
        }

        .rarity-legendary {
            background: #f1c40f;
        }

        .item-price {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Wallet Styles */
        .wallet-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .wallet-balances {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .balance-card {
            background: rgba(41, 47, 54, 0.8);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .balance-icon {
            font-size: 30px;
        }

        .balance-amount {
            font-size: 24px;
            font-weight: bold;
        }

        .wallet-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .transaction-history {
            background: rgba(41, 47, 54, 0.8);
            border-radius: 15px;
            padding: 15px;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Animations */
        @keyframes damage {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); background-color: rgba(255, 107, 107, 0.5); }
            100% { transform: scale(1); }
        }

        @keyframes heal {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); background-color: rgba(6, 214, 160, 0.5); }
            100% { transform: scale(1); }
        }

        @keyframes critical {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); background-color: rgba(255, 209, 102, 0.7); }
            100% { transform: scale(1); }
        }

        .damage-animation {
            animation: damage 0.5s ease;
        }

        .heal-animation {
            animation: heal 0.5s ease;
        }

        .critical-animation {
            animation: critical 0.5s ease;
        }

        /* Responsive Design */
        @media (min-width: 768px) {
            .container {
                max-width: 600px;
                margin: 0 auto;
            }
            
            .menu-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .shop-items {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .battle-actions {
                grid-template-columns: repeat(6, 1fr);
            }
        }

        /* Inventory Styles */
        .inventory-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .tab-btn {
            padding: 10px 15px;
            background: rgba(41, 47, 54, 0.8);
            border: none;
            border-radius: 20px;
            color: white;
            cursor: pointer;
            white-space: nowrap;
        }

        .tab-btn.active {
            background: var(--primary);
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .inventory-item {
            background: rgba(41, 47, 54, 0.8);
            border-radius: 15px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            position: relative;
        }

        .equipped-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--success);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        /* Settings Styles */
        .settings-section {
            background: rgba(41, 47, 54, 0.8);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .settings-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--secondary);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.2);
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--success);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* Achievements Styles */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 15px;
        }

        @media (min-width: 768px) {
            .achievements-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .achievement-card {
            background: rgba(41, 47, 54, 0.8);
            border-radius: 15px;
            padding: 15px;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .achievement-icon {
            font-size: 30px;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .achievement-info {
            flex: 1;
        }

        .achievement-progress {
            height: 5px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
        }

        .achievement-progress-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.5s ease;
        }

        .achievement-locked {
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
        <div id="main-menu" class="screen active">
            <div class="header">
                <div class="player-info">
                    <div class="player-avatar">üêπ</div>
                    <div class="player-stats">
                        <div class="player-name">–•–∞–º–µ—Å—Ç–µ—Ä</div>
                        <div class="player-level">–£—Ä–æ–≤–µ–Ω—å <span id="player-level">1</span></div>
                    </div>
                </div>
                <div class="currency-display">
                    <div class="currency">ü™ô <span id="coins-balance">100</span></div>
                    <div class="currency">üíé <span id="crystals-balance">10</span></div>
                </div>
            </div>

            <div class="menu-grid">
                <div class="menu-card" onclick="showScreen('battle-screen')">
                    <div class="menu-icon">‚öîÔ∏è</div>
                    <div>–ê—Ä–µ–Ω–∞ –±–∏—Ç–≤</div>
                </div>
                <div class="menu-card" onclick="showScreen('shop-screen')">
                    <div class="menu-icon">üè™</div>
                    <div>–ú–∞–≥–∞–∑–∏–Ω</div>
                </div>
                <div class="menu-card" onclick="showScreen('inventory-screen')">
                    <div class="menu-icon">üéí</div>
                    <div>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
                </div>
                <div class="menu-card" onclick="showScreen('wallet-screen')">
                    <div class="menu-icon">üí∞</div>
                    <div>–ö–æ—à–µ–ª–µ–∫</div>
                </div>
                <div class="menu-card" onclick="showScreen('achievements-screen')">
                    <div class="menu-icon">üèÜ</div>
                    <div>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</div>
                </div>
                <div class="menu-card" onclick="showScreen('settings-screen')">
                    <div class="menu-icon">‚öôÔ∏è</div>
                    <div>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –±–∏—Ç–≤—ã -->
        <div id="battle-screen" class="screen">
            <div class="header">
                <button class="btn btn-secondary" onclick="showScreen('main-menu')">‚Üê –ù–∞–∑–∞–¥</button>
                <div class="currency-display">
                    <div class="currency">ü™ô <span id="battle-coins">100</span></div>
                    <div class="currency">üíé <span id="battle-crystals">10</span></div>
                </div>
            </div>

            <div class="battle-container">
                <div class="battle-field">
                    <div class="character">
                        <div class="character-avatar player-character" id="player-avatar">üêπ</div>
                        <div class="health-bar">
                            <div class="health-fill" id="player-health" style="width: 100%;"></div>
                        </div>
                        <div>–•–∞–º–µ—Å—Ç–µ—Ä</div>
                    </div>
                    <div class="character">
                        <div class="character-avatar enemy-character" id="enemy-avatar">üê≠</div>
                        <div class="health-bar">
                            <div class="health-fill enemy-health-fill" id="enemy-health" style="width: 100%;"></div>
                        </div>
                        <div id="enemy-name">–ö—Ä—ã—Å–∞</div>
                    </div>
                </div>

                <div class="battle-log" id="battle-log">
                    <div>–ë–∏—Ç–≤–∞ –Ω–∞—á–∞–ª–∞—Å—å! –•–∞–º–µ—Å—Ç–µ—Ä –ø—Ä–æ—Ç–∏–≤ –ö—Ä—ã—Å—ã!</div>
                </div>

                <div class="battle-actions">
                    <button class="action-btn" onclick="playerAction('attack')">
                        <div>‚öîÔ∏è</div>
                        <div>–ê—Ç–∞–∫–∞</div>
                    </button>
                    <button class="action-btn" onclick="playerAction('defend')">
                        <div>üõ°Ô∏è</div>
                        <div>–ó–∞—â–∏—Ç–∞</div>
                    </button>
                    <button class="action-btn" onclick="playerAction('super')">
                        <div>üí•</div>
                        <div>–°—É–ø–µ—Ä-—É–¥–∞—Ä</div>
                    </button>
                    <button class="action-btn" onclick="playerAction('heal')">
                        <div>‚ù§Ô∏è</div>
                        <div>–õ–µ—á–µ–Ω–∏–µ</div>
                    </button>
                    <button class="action-btn" onclick="playerAction('item')">
                        <div>üéí</div>
                        <div>–ü—Ä–µ–¥–º–µ—Ç—ã</div>
                    </button>
                    <button class="action-btn" onclick="playerAction('escape')">
                        <div>üèÉ</div>
                        <div>–ü–æ–±–µ–≥</div>
                    </button>
                </div>
            </div>
        </div>

        <!-- –ú–∞–≥–∞–∑–∏–Ω -->
        <div id="shop-screen" class="screen">
            <div class="header">
                <button class="btn btn-secondary" onclick="showScreen('main-menu')">‚Üê –ù–∞–∑–∞–¥</button>
                <div class="currency-display">
                    <div class="currency">ü™ô <span id="shop-coins">100</span></div>
                    <div class="currency">üíé <span id="shop-crystals">10</span></div>
                </div>
            </div>

            <div class="shop-categories">
                <button class="category-btn active" onclick="changeShopCategory('weapons')">‚öîÔ∏è –û—Ä—É–∂–∏–µ</button>
                <button class="category-btn" onclick="changeShopCategory('armor')">üõ°Ô∏è –ë—Ä–æ–Ω—è</button>
                <button class="category-btn" onclick="changeShopCategory('potions')">üß™ –ó–µ–ª—å—è</button>
                <button class="category-btn" onclick="changeShopCategory('special')">üéØ –û—Å–æ–±—ã–µ</button>
                <button class="category-btn" onclick="changeShopCategory('premium')">üíé –ü—Ä–µ–º–∏—É–º</button>
            </div>

            <div class="shop-items" id="shop-items">
                <!-- Items will be loaded here by JavaScript -->
            </div>
        </div>

        <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
        <div id="inventory-screen" class="screen">
            <div class="header">
                <button class="btn btn-secondary" onclick="showScreen('main-menu')">‚Üê –ù–∞–∑–∞–¥</button>
                <div class="currency-display">
                    <div class="currency">ü™ô <span id="inventory-coins">100</span></div>
                    <div class="currency">üíé <span id="inventory-crystals">10</span></div>
                </div>
            </div>

            <div class="inventory-tabs">
                <button class="tab-btn active" onclick="changeInventoryTab('weapons')">‚öîÔ∏è –û—Ä—É–∂–∏–µ</button>
                <button class="tab-btn" onclick="changeInventoryTab('armor')">üõ°Ô∏è –ë—Ä–æ–Ω—è</button>
                <button class="tab-btn" onclick="changeInventoryTab('potions')">üß™ –ó–µ–ª—å—è</button>
                <button class="tab-btn" onclick="changeInventoryTab('special')">üéØ –û—Å–æ–±—ã–µ</button>
            </div>

            <div class="inventory-grid" id="inventory-items">
                <!-- Inventory items will be loaded here by JavaScript -->
            </div>
        </div>

        <!-- –ö–æ—à–µ–ª–µ–∫ -->
        <div id="wallet-screen" class="screen">
            <div class="header">
                <button class="btn btn-secondary" onclick="showScreen('main-menu')">‚Üê –ù–∞–∑–∞–¥</button>
                <div class="currency-display">
                    <div class="currency">ü™ô <span id="wallet-coins">100</span></div>
                    <div class="currency">üíé <span id="wallet-crystals">10</span></div>
                </div>
            </div>

            <div class="wallet-container">
                <div class="wallet-balances">
                    <div class="balance-card">
                        <div class="balance-icon">‚ö°</div>
                        <div>TON</div>
                        <div class="balance-amount" id="ton-balance">0</div>
                    </div>
                    <div class="balance-card">
                        <div class="balance-icon">üíµ</div>
                        <div>USDT</div>
                        <div class="balance-amount" id="usdt-balance">0</div>
                    </div>
                </div>

                <div class="wallet-actions">
                    <button class="btn btn-primary" onclick="depositTON()">–ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</button>
                    <button class="btn btn-primary" onclick="depositUSDT()">–ü–æ–ø–æ–ª–Ω–∏—Ç—å USDT</button>
                    <button class="btn btn-secondary" onclick="withdrawTON()">–í—ã–≤–µ—Å—Ç–∏ TON</button>
                    <button class="btn btn-secondary" onclick="withdrawUSDT()">–í—ã–≤–µ—Å—Ç–∏ USDT</button>
                </div>

                <div class="transaction-history">
                    <h3>–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</h3>
                    <div id="transaction-list">
                        <!-- Transactions will be loaded here by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
        <div id="achievements-screen" class="screen">
            <div class="header">
                <button class="btn btn-secondary" onclick="showScreen('main-menu')">‚Üê –ù–∞–∑–∞–¥</button>
                <div class="currency-display">
                    <div class="currency">ü™ô <span id="achievements-coins">100</span></div>
                    <div class="currency">üíé <span id="achievements-crystals">10</span></div>
                </div>
            </div>

            <div class="achievements-grid" id="achievements-list">
                <!-- Achievements will be loaded here by JavaScript -->
            </div>
        </div>

        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div id="settings-screen" class="screen">
            <div class="header">
                <button class="btn btn-secondary" onclick="showScreen('main-menu')">‚Üê –ù–∞–∑–∞–¥</button>
                <div class="currency-display">
                    <div class="currency">ü™ô <span id="settings-coins">100</span></div>
                    <div class="currency">üíé <span id="settings-crystals">10</span></div>
                </div>
            </div>

            <div class="settings-section">
                <div class="settings-title">–ó–≤—É–∫ –∏ –º—É–∑—ã–∫–∞</div>
                <div class="setting-item">
                    <div>–§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞</div>
                    <label class="switch">
                        <input type="checkbox" id="music-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div>–ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</div>
                    <label class="switch">
                        <input type="checkbox" id="sound-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <div class="settings-section">
                <div class="settings-title">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                <div class="setting-item">
                    <div>–ò–≥—Ä–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                    <label class="switch">
                        <input type="checkbox" id="notifications-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –±–æ–Ω—É—Å—ã</div>
                    <label class="switch">
                        <input type="checkbox" id="bonus-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <div class="settings-section">
                <div class="settings-title">–ò–≥—Ä–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å</div>
                <div class="setting-item">
                    <div>–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</div>
                    <label class="switch">
                        <input type="checkbox" id="autosave-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞</div>
                    <label class="switch">
                        <input type="checkbox" id="confirm-exit-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <button class="btn btn-large btn-primary" onclick="saveGame()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä—É</button>
            <button class="btn btn-large btn-secondary" onclick="loadGame()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–≥—Ä—É</button>
            <button class="btn btn-large btn-danger" onclick="resetGame()">–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = window.Telegram?.WebApp;
        
        // –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤ Telegram
        if (tg) {
            tg.ready();
            tg.expand();
            tg.enableClosingConfirmation();
        }

        // –ò–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        let gameData = {
            player: {
                level: 1,
                exp: 0,
                expToNextLevel: 100,
                health: 100,
                maxHealth: 100,
                attack: 10,
                defense: 5,
                speed: 10,
                critChance: 5,
                critDamage: 150
            },
            currencies: {
                coins: 100,
                crystals: 10,
                ton: 0,
                usdt: 0
            },
            inventory: {
                weapons: [],
                armor: [],
                potions: [
                    { id: 'potion1', name: '–ú–∞–ª–æ–µ –∑–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è', icon: 'üß™', effect: 'heal', value: 30, quantity: 3 }
                ],
                special: []
            },
            equipped: {
                weapon: null,
                armor: null
            },
            achievements: [
                { id: 'first_win', name: '–ü–µ—Ä–≤–∞—è –ø–æ–±–µ–¥–∞', description: '–û–¥–æ–ª–µ–π—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ä–∞–≥–∞', icon: 'üèÜ', progress: 0, maxProgress: 1, completed: false, reward: { coins: 50, crystals: 5 } },
                { id: 'level_10', name: '–û–ø—ã—Ç–Ω—ã–π –±–æ–µ—Ü', description: '–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 10 —É—Ä–æ–≤–Ω—è', icon: '‚≠ê', progress: 1, maxProgress: 10, completed: false, reward: { coins: 100, crystals: 10 } },
                { id: 'rich_hamster', name: '–ë–æ–≥–∞—Ç—ã–π —Ö–æ–º—è–∫', description: '–ù–∞–∫–æ–ø–∏—Ç–µ 1000 –º–æ–Ω–µ—Ç', icon: 'üí∞', progress: 100, maxProgress: 1000, completed: false, reward: { coins: 200, crystals: 20 } }
            ],
            battle: {
                currentEnemy: null,
                playerDefending: false,
                enemyDefending: false,
                battleLog: []
            },
            settings: {
                music: true,
                sound: true,
                notifications: true,
                dailyBonus: true,
                autosave: true,
                confirmExit: true
            },
            transactions: []
        };

        // –í—Ä–∞–≥–∏
        const enemies = [
            { id: 'rat', name: '–ö—Ä—ã—Å–∞', icon: 'üê≠', level: 1, health: 50, maxHealth: 50, attack: 8, defense: 3, speed: 12, expReward: 20, coinReward: 10 },
            { id: 'snake', name: '–ó–º–µ—è', icon: 'üêç', level: 3, health: 70, maxHealth: 70, attack: 12, defense: 5, speed: 15, expReward: 35, coinReward: 20 },
            { id: 'fox', name: '–õ–∏—Å–∞', icon: 'ü¶ä', level: 5, health: 100, maxHealth: 100, attack: 15, defense: 8, speed: 18, expReward: 50, coinReward: 30 }
        ];

        // –ü—Ä–µ–¥–º–µ—Ç—ã –≤ –º–∞–≥–∞–∑–∏–Ω–µ
        const shopItems = {
            weapons: [
                { id: 'wooden_sword', name: '–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π –º–µ—á', icon: '‚öîÔ∏è', rarity: 'common', price: 50, attack: 5, type: 'weapon' },
                { id: 'iron_sword', name: '–ñ–µ–ª–µ–∑–Ω—ã–π –º–µ—á', icon: '‚öîÔ∏è', rarity: 'rare', price: 150, attack: 10, type: 'weapon' },
                { id: 'steel_sword', name: '–°—Ç–∞–ª—å–Ω–æ–π –º–µ—á', icon: '‚öîÔ∏è', rarity: 'epic', price: 300, attack: 15, type: 'weapon' }
            ],
            armor: [
                { id: 'leather_armor', name: '–ö–æ–∂–∞–Ω–∞—è –±—Ä–æ–Ω—è', icon: 'üõ°Ô∏è', rarity: 'common', price: 50, defense: 5, type: 'armor' },
                { id: 'chain_armor', name: '–ö–æ–ª—å—á—É–≥–∞', icon: 'üõ°Ô∏è', rarity: 'rare', price: 150, defense: 10, type: 'armor' },
                { id: 'plate_armor', name: '–õ–∞—Ç–Ω–∞—è –±—Ä–æ–Ω—è', icon: 'üõ°Ô∏è', rarity: 'epic', price: 300, defense: 15, type: 'armor' }
            ],
            potions: [
                { id: 'small_heal_potion', name: '–ú–∞–ª–æ–µ –∑–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è', icon: 'üß™', rarity: 'common', price: 20, effect: 'heal', value: 30, type: 'potion' },
                { id: 'medium_heal_potion', name: '–°—Ä–µ–¥–Ω–µ–µ –∑–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è', icon: 'üß™', rarity: 'rare', price: 50, effect: 'heal', value: 60, type: 'potion' },
                { id: 'large_heal_potion', name: '–ë–æ–ª—å—à–æ–µ –∑–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è', icon: 'üß™', rarity: 'epic', price: 100, effect: 'heal', value: 100, type: 'potion' }
            ],
            special: [
                { id: 'attack_boost', name: '–£—Å–∏–ª–µ–Ω–∏–µ –∞—Ç–∞–∫–∏', icon: 'üí™', rarity: 'rare', price: 80, effect: 'attack_boost', value: 10, duration: 3, type: 'special' },
                { id: 'defense_boost', name: '–£—Å–∏–ª–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã', icon: 'üõ°Ô∏è', rarity: 'rare', price: 80, effect: 'defense_boost', value: 10, duration: 3, type: 'special' },
                { id: 'speed_boost', name: '–£—Å–∏–ª–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏', icon: '‚ö°', rarity: 'epic', price: 120, effect: 'speed_boost', value: 10, duration: 3, type: 'special' }
            ],
            premium: [
                { id: 'crystal_pack_1', name: '–ù–∞–±–æ—Ä –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤ (10)', icon: 'üíé', rarity: 'rare', price: 1, currency: 'ton', value: 10, type: 'premium' },
                { id: 'crystal_pack_2', name: '–ù–∞–±–æ—Ä –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤ (50)', icon: 'üíé', rarity: 'epic', price: 4, currency: 'ton', value: 50, type: 'premium' },
                { id: 'crystal_pack_3', name: '–ù–∞–±–æ—Ä –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤ (100)', icon: 'üíé', rarity: 'legendary', price: 7, currency: 'ton', value: 100, type: 'premium' }
            ]
        };

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —ç–∫—Ä–∞–Ω–∞–º–∏
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å—ã –Ω–∞ –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–∞—Ö
            updateBalances();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
            if (screenId === 'shop-screen') {
                loadShopItems('weapons');
            } else if (screenId === 'inventory-screen') {
                loadInventoryItems('weapons');
            } else if (screenId === 'achievements-screen') {
                loadAchievements();
            } else if (screenId === 'wallet-screen') {
                loadTransactions();
            } else if (screenId === 'battle-screen') {
                startBattle();
            }
        }

        function updateBalances() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å—ã –Ω–∞ –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–∞—Ö
            const coinsElements = document.querySelectorAll('#coins-balance, #battle-coins, #shop-coins, #inventory-coins, #wallet-coins, #achievements-coins, #settings-coins');
            const crystalsElements = document.querySelectorAll('#crystals-balance, #battle-crystals, #shop-crystals, #inventory-crystals, #wallet-crystals, #achievements-crystals, #settings-crystals');
            
            coinsElements.forEach(el => {
                el.textContent = gameData.currencies.coins;
            });
            
            crystalsElements.forEach(el => {
                el.textContent = gameData.currencies.crystals;
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —É—Ä–æ–≤–µ–Ω—å –∏–≥—Ä–æ–∫–∞
            document.getElementById('player-level').textContent = gameData.player.level;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å—ã TON –∏ USDT
            document.getElementById('ton-balance').textContent = gameData.currencies.ton;
            document.getElementById('usdt-balance').textContent = gameData.currencies.usdt;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞
        function changeShopCategory(category) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–µ
            event.target.classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–µ–¥–º–µ—Ç—ã –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            loadShopItems(category);
        }

        function loadShopItems(category) {
            const shopItemsContainer = document.getElementById('shop-items');
            shopItemsContainer.innerHTML = '';
            
            const items = shopItems[category];
            
            items.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'shop-item';
                
                let priceHTML = '';
                if (item.currency === 'ton') {
                    priceHTML = `<div class="item-price">
                        <span>${item.price} ‚ö° TON</span>
                        <button class="btn btn-primary" onclick="buyItem('${item.id}', '${category}')">–ö—É–ø–∏—Ç—å</button>
                    </div>`;
                } else {
                    priceHTML = `<div class="item-price">
                        <span>${item.price} ü™ô</span>
                        <button class="btn btn-primary" onclick="buyItem('${item.id}', '${category}')">–ö—É–ø–∏—Ç—å</button>
                    </div>`;
                }
                
                itemElement.innerHTML = `
                    <div class="item-header">
                        <div class="item-icon">${item.icon}</div>
                        <div class="item-rarity rarity-${item.rarity}">${getRarityName(item.rarity)}</div>
                    </div>
                    <div class="item-name">${item.name}</div>
                    ${item.effect ? `<div class="item-effect">${getEffectDescription(item)}</div>` : ''}
                    ${priceHTML}
                `;
                
                shopItemsContainer.appendChild(itemElement);
            });
        }

        function getRarityName(rarity) {
            const rarityNames = {
                'common': '–û–±—ã—á–Ω—ã–π',
                'rare': '–†–µ–¥–∫–∏–π',
                'epic': '–≠–ø–∏—á–µ—Å–∫–∏–π',
                'legendary': '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π'
            };
            return rarityNames[rarity] || rarity;
        }

        function getEffectDescription(item) {
            if (item.effect === 'heal') {
                return `–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç ${item.value} –∑–¥–æ—Ä–æ–≤—å—è`;
            } else if (item.effect === 'attack_boost') {
                return `–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∞—Ç–∞–∫—É –Ω–∞ ${item.value} –Ω–∞ ${item.duration} —Ö–æ–¥–∞`;
            } else if (item.effect === 'defense_boost') {
                return `–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∑–∞—â–∏—Ç—É –Ω–∞ ${item.value} –Ω–∞ ${item.duration} —Ö–æ–¥–∞`;
            } else if (item.effect === 'speed_boost') {
                return `–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞ ${item.value} –Ω–∞ ${item.duration} —Ö–æ–¥–∞`;
            }
            return '';
        }

        function buyItem(itemId, category) {
            const item = shopItems[category].find(i => i.id === itemId);
            
            if (!item) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ –≤–∞–ª—é—Ç—ã
            if (item.currency === 'ton') {
                if (gameData.currencies.ton < item.price) {
                    alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON –¥–ª—è –ø–æ–∫—É–ø–∫–∏!');
                    return;
                }
                gameData.currencies.ton -= item.price;
            } else {
                if (gameData.currencies.coins < item.price) {
                    alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏!');
                    return;
                }
                gameData.currencies.coins -= item.price;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–µ–¥–º–µ—Ç –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
            if (item.type === 'weapon') {
                gameData.inventory.weapons.push({ ...item, equipped: false });
            } else if (item.type === 'armor') {
                gameData.inventory.armor.push({ ...item, equipped: false });
            } else if (item.type === 'potion') {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–∞–∫–æ–µ –∑–µ–ª—å–µ
                const existingPotion = gameData.inventory.potions.find(p => p.id === item.id);
                if (existingPotion) {
                    existingPotion.quantity += 1;
                } else {
                    gameData.inventory.potions.push({ ...item, quantity: 1 });
                }
            } else if (item.type === 'special') {
                gameData.inventory.special.push({ ...item, quantity: 1 });
            } else if (item.type === 'premium') {
                gameData.currencies.crystals += item.value;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å—ã
            updateBalances();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –ø–æ–∫—É–ø–∫–µ
            alert(`–í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–æ–±—Ä–µ–ª–∏: ${item.name}`);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä—É
            saveGame();
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function changeInventoryTab(tab) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ
            event.target.classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–µ–¥–º–µ—Ç—ã –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
            loadInventoryItems(tab);
        }

        function loadInventoryItems(tab) {
            const inventoryContainer = document.getElementById('inventory-items');
            inventoryContainer.innerHTML = '';
            
            const items = gameData.inventory[tab];
            
            if (items.length === 0) {
                inventoryContainer.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; padding: 20px;">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>';
                return;
            }
            
            items.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'inventory-item';
                
                let actionButton = '';
                if (tab === 'weapons' || tab === 'armor') {
                    if (item.equipped) {
                        actionButton = `<button class="btn btn-secondary" onclick="unequipItem('${tab}', ${index})">–°–Ω—è—Ç—å</button>`;
                    } else {
                        actionButton = `<button class="btn btn-primary" onclick="equipItem('${tab}', ${index})">–ù–∞–¥–µ—Ç—å</button>`;
                    }
                } else if (tab === 'potions' || tab === 'special') {
                    actionButton = `<button class="btn btn-primary" onclick="useItem('${tab}', ${index})">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button>`;
                }
                
                itemElement.innerHTML = `
                    ${item.equipped ? '<div class="equipped-badge">‚úì</div>' : ''}
                    <div class="item-icon">${item.icon}</div>
                    <div class="item-name">${item.name}</div>
                    ${item.effect ? `<div class="item-effect">${getEffectDescription(item)}</div>` : ''}
                    ${item.quantity ? `<div class="item-quantity">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${item.quantity}</div>` : ''}
                    ${actionButton}
                `;
                
                inventoryContainer.appendChild(itemElement);
            });
        }

        function equipItem(type, index) {
            const item = gameData.inventory[type][index];
            
            // –°–Ω–∏–º–∞–µ–º —Ç–µ–∫—É—â–∏–π —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç
            if (type === 'weapons' && gameData.equipped.weapon !== null) {
                const currentWeaponIndex = gameData.inventory.weapons.findIndex(w => w.id === gameData.equipped.weapon.id);
                if (currentWeaponIndex !== -1) {
                    gameData.inventory.weapons[currentWeaponIndex].equipped = false;
                }
            } else if (type === 'armor' && gameData.equipped.armor !== null) {
                const currentArmorIndex = gameData.inventory.armor.findIndex(a => a.id === gameData.equipped.armor.id);
                if (currentArmorIndex !== -1) {
                    gameData.inventory.armor[currentArmorIndex].equipped = false;
                }
            }
            
            // –≠–∫–∏–ø–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç
            item.equipped = true;
            
            if (type === 'weapons') {
                gameData.equipped.weapon = item;
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∞—Ç–∞–∫—É –∏–≥—Ä–æ–∫–∞
                gameData.player.attack += item.attack;
            } else if (type === 'armor') {
                gameData.equipped.armor = item;
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∑–∞—â–∏—Ç—É –∏–≥—Ä–æ–∫–∞
                gameData.player.defense += item.defense;
            }
            
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
            loadInventoryItems(type);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä—É
            saveGame();
            
            alert(`–í—ã —ç–∫–∏–ø–∏—Ä–æ–≤–∞–ª–∏: ${item.name}`);
        }

        function unequipItem(type, index) {
            const item = gameData.inventory[type][index];
            
            // –°–Ω–∏–º–∞–µ–º –ø—Ä–µ–¥–º–µ—Ç
            item.equipped = false;
            
            if (type === 'weapons') {
                // –£–º–µ–Ω—å—à–∞–µ–º –∞—Ç–∞–∫—É –∏–≥—Ä–æ–∫–∞
                gameData.player.attack -= item.attack;
                gameData.equipped.weapon = null;
            } else if (type === 'armor') {
                // –£–º–µ–Ω—å—à–∞–µ–º –∑–∞—â–∏—Ç—É –∏–≥—Ä–æ–∫–∞
                gameData.player.defense -= item.defense;
                gameData.equipped.armor = null;
            }
            
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
            loadInventoryItems(type);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä—É
            saveGame();
            
            alert(`–í—ã —Å–Ω—è–ª–∏: ${item.name}`);
        }

        function useItem(type, index) {
            const item = gameData.inventory[type][index];
            
            if (type === 'potions') {
                if (item.effect === 'heal') {
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–¥–æ—Ä–æ–≤—å–µ
                    gameData.player.health = Math.min(gameData.player.health + item.value, gameData.player.maxHealth);
                    
                    // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–µ–ª–∏–π
                    item.quantity -= 1;
                    
                    // –ï—Å–ª–∏ –∑–µ–ª—å—è –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å, —É–¥–∞–ª—è–µ–º –∏—Ö –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
                    if (item.quantity <= 0) {
                        gameData.inventory.potions.splice(index, 1);
                    }
                    
                    alert(`–í—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ ${item.name} –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ ${item.value} –∑–¥–æ—Ä–æ–≤—å—è!`);
                }
            } else if (type === 'special') {
                // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Å–æ–±—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (–±–∞—Ñ—Ñ–æ–≤)
                // –í —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞
                item.quantity -= 1;
                
                if (item.quantity <= 0) {
                    gameData.inventory.special.splice(index, 1);
                }
                
                alert(`–í—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ ${item.name}!`);
            }
            
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
            loadInventoryItems(type);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä—É
            saveGame();
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –±–∏—Ç–≤—ã
        function startBattle() {
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≤—Ä–∞–≥–∞
            const randomEnemyIndex = Math.floor(Math.random() * enemies.length);
            gameData.battle.currentEnemy = { ...enemies[randomEnemyIndex] };
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞—â–∏—Ç—ã
            gameData.battle.playerDefending = false;
            gameData.battle.enemyDefending = false;
            
            // –û—á–∏—â–∞–µ–º –ª–æ–≥ –±–∏—Ç–≤—ã
            gameData.battle.battleLog = [];
            addBattleLog(`–ë–∏—Ç–≤–∞ –Ω–∞—á–∞–ª–∞—Å—å! –•–∞–º–µ—Å—Ç–µ—Ä –ø—Ä–æ—Ç–∏–≤ ${gameData.battle.currentEnemy.name}!`);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–∏—Ç–≤—ã
            updateBattleUI();
        }

        function updateBattleUI() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–¥–æ—Ä–æ–≤—å–µ –∏–≥—Ä–æ–∫–∞ –∏ –≤—Ä–∞–≥–∞
            const playerHealthPercent = (gameData.player.health / gameData.player.maxHealth) * 100;
            const enemyHealthPercent = (gameData.battle.currentEnemy.health / gameData.battle.currentEnemy.maxHealth) * 100;
            
            document.getElementById('player-health').style.width = `${playerHealthPercent}%`;
            document.getElementById('enemy-health').style.width = `${enemyHealthPercent}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä –≤—Ä–∞–≥–∞ –∏ –∏–º—è
            document.getElementById('enemy-avatar').textContent = gameData.battle.currentEnemy.icon;
            document.getElementById('enemy-name').textContent = gameData.battle.currentEnemy.name;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ª–æ–≥ –±–∏—Ç–≤—ã
            const battleLogElement = document.getElementById('battle-log');
            battleLogElement.innerHTML = '';
            
            gameData.battle.battleLog.forEach(logEntry => {
                const logElement = document.createElement('div');
                logElement.textContent = logEntry;
                battleLogElement.appendChild(logElement);
            });
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –ª–æ–≥ –≤–Ω–∏–∑
            battleLogElement.scrollTop = battleLogElement.scrollHeight;
        }

        function addBattleLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            gameData.battle.battleLog.push(`[${timestamp}] ${message}`);
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –ª–æ–≥ 50 —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
            if (gameData.battle.battleLog.length > 50) {
                gameData.battle.battleLog.shift();
            }
            
            updateBattleUI();
        }

        function playerAction(action) {
            if (!gameData.battle.currentEnemy) return;
            
            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ –∏–≥—Ä–æ–∫–∞
            switch (action) {
                case 'attack':
                    performPlayerAttack();
                    break;
                case 'defend':
                    performPlayerDefend();
                    break;
                case 'super':
                    performPlayerSuper();
                    break;
                case 'heal':
                    performPlayerHeal();
                    break;
                case 'item':
                    // –í —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ –∑–¥–µ—Å—å –±—ã–ª –±—ã –≤—ã–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–∞
                    alert('–í –ø–æ–ª–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –≤—ã–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–∞ –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è');
                    return;
                case 'escape':
                    performPlayerEscape();
                    return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å –ª–∏ –±–∏—Ç–≤–∞
            if (gameData.battle.currentEnemy.health <= 0) {
                playerWin();
                return;
            }
            
            // –•–æ–¥ –≤—Ä–∞–≥–∞
            enemyTurn();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø—Ä–æ–∏–≥—Ä–∞–ª –ª–∏ –∏–≥—Ä–æ–∫
            if (gameData.player.health <= 0) {
                playerLose();
                return;
            }
        }

        function performPlayerAttack() {
            const player = gameData.player;
            const enemy = gameData.battle.currentEnemy;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É–¥–∞—Ä
            const isCritical = Math.random() * 100 < player.critChance;
            let damage = player.attack;
            
            if (isCritical) {
                damage = Math.floor(damage * (player.critDamage / 100));
                addBattleLog(`‚ö° –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É–¥–∞—Ä! –•–∞–º–µ—Å—Ç–µ—Ä –∞—Ç–∞–∫—É–µ—Ç –∏ –Ω–∞–Ω–æ—Å–∏—Ç ${damage} —É—Ä–æ–Ω–∞!`);
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞—Ä–∞
                document.getElementById('enemy-avatar').classList.add('critical-animation');
                setTimeout(() => {
                    document.getElementById('enemy-avatar').classList.remove('critical-animation');
                }, 500);
            } else {
                addBattleLog(`‚öîÔ∏è –•–∞–º–µ—Å—Ç–µ—Ä –∞—Ç–∞–∫—É–µ—Ç –∏ –Ω–∞–Ω–æ—Å–∏—Ç ${damage} —É—Ä–æ–Ω–∞!`);
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –æ–±—ã—á–Ω–æ–≥–æ —É—Ä–æ–Ω–∞
                document.getElementById('enemy-avatar').classList.add('damage-animation');
                setTimeout(() => {
                    document.getElementById('enemy-avatar').classList.remove('damage-animation');
                }, 500);
            }
            
            // –£—á–∏—Ç—ã–≤–∞–µ–º –∑–∞—â–∏—Ç—É –≤—Ä–∞–≥–∞
            if (gameData.battle.enemyDefending) {
                damage = Math.max(1, Math.floor(damage / 2));
                addBattleLog(`üõ°Ô∏è ${enemy.name} –∑–∞—â–∏—â–∞–µ—Ç—Å—è, —É—Ä–æ–Ω —É–º–µ–Ω—å—à–µ–Ω!`);
                gameData.battle.enemyDefending = false;
            }
            
            // –ù–∞–Ω–æ—Å–∏–º —É—Ä–æ–Ω –≤—Ä–∞–≥—É
            enemy.health = Math.max(0, enemy.health - damage);
        }

        function performPlayerDefend() {
            gameData.battle.playerDefending = true;
            addBattleLog(`üõ°Ô∏è –•–∞–º–µ—Å—Ç–µ—Ä –≥–æ—Ç–æ–≤–∏—Ç—Å—è –∫ –∑–∞—â–∏—Ç–µ!`);
        }

        function performPlayerSuper() {
            const player = gameData.player;
            const enemy = gameData.battle.currentEnemy;
            
            // –°—É–ø–µ—Ä-—É–¥–∞—Ä —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏ (–≤ —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ)
            const damage = Math.floor(player.attack * 1.5);
            
            addBattleLog(`üí• –•–∞–º–µ—Å—Ç–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É–ø–µ—Ä-—É–¥–∞—Ä –∏ –Ω–∞–Ω–æ—Å–∏—Ç ${damage} —É—Ä–æ–Ω–∞!`);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —Å—É–ø–µ—Ä-—É–¥–∞—Ä–∞
            document.getElementById('enemy-avatar').classList.add('critical-animation');
            setTimeout(() => {
                document.getElementById('enemy-avatar').classList.remove('critical-animation');
            }, 500);
            
            // –£—á–∏—Ç—ã–≤–∞–µ–º –∑–∞—â–∏—Ç—É –≤—Ä–∞–≥–∞
            if (gameData.battle.enemyDefending) {
                const reducedDamage = Math.max(1, Math.floor(damage / 2));
                addBattleLog(`üõ°Ô∏è ${enemy.name} –∑–∞—â–∏—â–∞–µ—Ç—Å—è, —É—Ä–æ–Ω —É–º–µ–Ω—å—à–µ–Ω!`);
                gameData.battle.enemyDefending = false;
            }
            
            // –ù–∞–Ω–æ—Å–∏–º —É—Ä–æ–Ω –≤—Ä–∞–≥—É
            enemy.health = Math.max(0, enemy.health - damage);
        }

        function performPlayerHeal() {
            const player = gameData.player;
            const healAmount = Math.floor(player.maxHealth * 0.3);
            
            player.health = Math.min(player.maxHealth, player.health + healAmount);
            
            addBattleLog(`‚ù§Ô∏è –•–∞–º–µ—Å—Ç–µ—Ä –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç ${healAmount} –∑–¥–æ—Ä–æ–≤—å—è!`);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ª–µ—á–µ–Ω–∏—è
            document.getElementById('player-avatar').classList.add('heal-animation');
            setTimeout(() => {
                document.getElementById('player-avatar').classList.remove('heal-animation');
            }, 500);
        }

        function performPlayerEscape() {
            const escapeChance = 70; // 70% —à–∞–Ω—Å –ø–æ–±–µ–≥–∞
            
            if (Math.random() * 100 < escapeChance) {
                addBattleLog(`üèÉ –•–∞–º–µ—Å—Ç–µ—Ä —É—Å–ø–µ—à–Ω–æ —Å–±–µ–∂–∞–ª —Å –ø–æ–ª—è –±–æ—è!`);
                setTimeout(() => {
                    showScreen('main-menu');
                }, 1500);
            } else {
                addBattleLog(`üèÉ –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–±–µ–≥–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å!`);
                enemyTurn();
            }
        }

        function enemyTurn() {
            const enemy = gameData.battle.currentEnemy;
            
            // –ü—Ä–æ—Å—Ç–æ–π –ò–ò –¥–ª—è –≤—Ä–∞–≥–∞
            const actions = ['attack', 'defend'];
            const randomAction = actions[Math.floor(Math.random() * actions.length)];
            
            switch (randomAction) {
                case 'attack':
                    performEnemyAttack();
                    break;
                case 'defend':
                    performEnemyDefend();
                    break;
            }
        }

        function performEnemyAttack() {
            const player = gameData.player;
            const enemy = gameData.battle.currentEnemy;
            
            let damage = enemy.attack;
            
            addBattleLog(`‚öîÔ∏è ${enemy.name} –∞—Ç–∞–∫—É–µ—Ç –∏ –Ω–∞–Ω–æ—Å–∏—Ç ${damage} —É—Ä–æ–Ω–∞!`);
            
            // –£—á–∏—Ç—ã–≤–∞–µ–º –∑–∞—â–∏—Ç—É –∏–≥—Ä–æ–∫–∞
            if (gameData.battle.playerDefending) {
                damage = Math.max(1, Math.floor(damage / 2));
                addBattleLog(`üõ°Ô∏è –•–∞–º–µ—Å—Ç–µ—Ä –∑–∞—â–∏—â–∞–µ—Ç—Å—è, —É—Ä–æ–Ω —É–º–µ–Ω—å—à–µ–Ω!`);
                gameData.battle.playerDefending = false;
            }
            
            // –ù–∞–Ω–æ—Å–∏–º —É—Ä–æ–Ω –∏–≥—Ä–æ–∫—É
            player.health = Math.max(0, player.health - damage);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —É—Ä–æ–Ω–∞
            document.getElementById('player-avatar').classList.add('damage-animation');
            setTimeout(() => {
                document.getElementById('player-avatar').classList.remove('damage-animation');
            }, 500);
        }

        function performEnemyDefend() {
            gameData.battle.enemyDefending = true;
            addBattleLog(`üõ°Ô∏è ${gameData.battle.currentEnemy.name} –≥–æ—Ç–æ–≤–∏—Ç—Å—è –∫ –∑–∞—â–∏—Ç–µ!`);
        }

        function playerWin() {
            const enemy = gameData.battle.currentEnemy;
            
            addBattleLog(`üéâ –ü–æ–±–µ–¥–∞! –•–∞–º–µ—Å—Ç–µ—Ä –æ–¥–æ–ª–µ–ª ${enemy.name}!`);
            
            // –ù–∞–≥—Ä–∞–∂–¥–∞–µ–º –∏–≥—Ä–æ–∫–∞
            gameData.currencies.coins += enemy.coinReward;
            gameData.player.exp += enemy.expReward;
            
            addBattleLog(`ü™ô –ü–æ–ª—É—á–µ–Ω–æ ${enemy.coinReward} –º–æ–Ω–µ—Ç!`);
            addBattleLog(`‚≠ê –ü–æ–ª—É—á–µ–Ω–æ ${enemy.expReward} –æ–ø—ã—Ç–∞!`);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø–æ–≤—ã—Å–∏–ª—Å—è –ª–∏ —É—Ä–æ–≤–µ–Ω—å
            checkLevelUp();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å—ã
            updateBalances();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä—É
            saveGame();
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                showScreen('main-menu');
            }, 3000);
        }

        function playerLose() {
            addBattleLog(`üíÄ –ü–æ—Ä–∞–∂–µ–Ω–∏–µ! –•–∞–º–µ—Å—Ç–µ—Ä –ø–æ–≤–µ—Ä–∂–µ–Ω...`);
            
            // –ò–≥—Ä–æ–∫ —Ç–µ—Ä—è–µ—Ç —á–∞—Å—Ç—å –º–æ–Ω–µ—Ç
            const coinsLost = Math.floor(gameData.currencies.coins * 0.1);
            gameData.currencies.coins = Math.max(0, gameData.currencies.coins - coinsLost);
            
            addBattleLog(`ü™ô –ü–æ—Ç–µ—Ä—è–Ω–æ ${coinsLost} –º–æ–Ω–µ—Ç!`);
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–¥–æ—Ä–æ–≤—å–µ –∏–≥—Ä–æ–∫–∞
            gameData.player.health = gameData.player.maxHealth;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å—ã
            updateBalances();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä—É
            saveGame();
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                showScreen('main-menu');
            }, 3000);
        }

        function checkLevelUp() {
            const player = gameData.player;
            
            if (player.exp >= player.expToNextLevel) {
                player.level += 1;
                player.exp -= player.expToNextLevel;
                player.expToNextLevel = Math.floor(player.expToNextLevel * 1.2);
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
                player.maxHealth += 10;
                player.health = player.maxHealth;
                player.attack += 2;
                player.defense += 1;
                player.speed += 1;
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —à–∞–Ω—Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞—Ä–∞ –∫–∞–∂–¥—ã–µ 5 —É—Ä–æ–≤–Ω–µ–π
                if (player.level % 5 === 0) {
                    player.critChance += 1;
                }
                
                addBattleLog(`üéä –£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω! –¢–µ–ø–µ—Ä—å —É –•–∞–º–µ—Å—Ç–µ—Ä–∞ ${player.level} —É—Ä–æ–≤–µ–Ω—å!`);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                checkAchievements();
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        function loadAchievements() {
            const achievementsContainer = document.getElementById('achievements-list');
            achievementsContainer.innerHTML = '';
            
            gameData.achievements.forEach(achievement => {
                const achievementElement = document.createElement('div');
                achievementElement.className = `achievement-card ${achievement.completed ? '' : 'achievement-locked'}`;
                
                const progressPercent = (achievement.progress / achievement.maxProgress) * 100;
                
                achievementElement.innerHTML = `
                    <div class="achievement-icon">${achievement.icon}</div>
                    <div class="achievement-info">
                        <div class="achievement-name">${achievement.name}</div>
                        <div class="achievement-description">${achievement.description}</div>
                        <div class="achievement-progress">
                            <div class="achievement-progress-fill" style="width: ${progressPercent}%;"></div>
                        </div>
                        <div class="achievement-progress-text">${achievement.progress}/${achievement.maxProgress}</div>
                    </div>
                    ${achievement.completed ? '<div class="achievement-reward">‚úÖ</div>' : ''}
                `;
                
                achievementsContainer.appendChild(achievementElement);
            });
        }

        function checkAchievements() {
            const player = gameData.player;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è 10
            const levelAchievement = gameData.achievements.find(a => a.id === 'level_10');
            if (levelAchievement && !levelAchievement.completed) {
                levelAchievement.progress = player.level;
                if (player.level >= levelAchievement.maxProgress) {
                    levelAchievement.completed = true;
                    awardAchievement(levelAchievement);
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –±–æ–≥–∞—Ç—Å—Ç–≤–∞
            const richAchievement = gameData.achievements.find(a => a.id === 'rich_hamster');
            if (richAchievement && !richAchievement.completed) {
                richAchievement.progress = gameData.currencies.coins;
                if (gameData.currencies.coins >= richAchievement.maxProgress) {
                    richAchievement.completed = true;
                    awardAchievement(richAchievement);
                }
            }
        }

        function awardAchievement(achievement) {
            // –ù–∞–≥—Ä–∞–∂–¥–∞–µ–º –∏–≥—Ä–æ–∫–∞
            if (achievement.reward.coins) {
                gameData.currencies.coins += achievement.reward.coins;
            }
            if (achievement.reward.crystals) {
                gameData.currencies.crystals += achievement.reward.crystals;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            alert(`–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: ${achievement.name}\n–ù–∞–≥—Ä–∞–¥–∞: ${achievement.reward.coins} ü™ô, ${achievement.reward.crystals} üíé`);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å—ã
            updateBalances();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä—É
            saveGame();
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–æ—à–µ–ª—å–∫–∞
        function loadTransactions() {
            const transactionList = document.getElementById('transaction-list');
            transactionList.innerHTML = '';
            
            if (gameData.transactions.length === 0) {
                transactionList.innerHTML = '<div style="text-align: center; padding: 20px;">–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø—É—Å—Ç–∞</div>';
                return;
            }
            
            gameData.transactions.forEach(transaction => {
                const transactionElement = document.createElement('div');
                transactionElement.className = 'transaction-item';
                
                const date = new Date(transaction.date).toLocaleDateString();
                const amount = transaction.amount > 0 ? `+${transaction.amount}` : transaction.amount;
                const typeClass = transaction.amount > 0 ? 'success' : 'danger';
                
                transactionElement.innerHTML = `
                    <div>
                        <div>${transaction.type}</div>
                        <div style="font-size: 12px; color: #aaa;">${date}</div>
                    </div>
                    <div class="text-${typeClass}">${amount} ${transaction.currency}</div>
                `;
                
                transactionList.appendChild(transactionElement);
            });
        }

        function addTransaction(type, amount, currency) {
            gameData.transactions.unshift({
                type,
                amount,
                currency,
                date: new Date().toISOString()
            });
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é 20 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
            if (gameData.transactions.length > 20) {
                gameData.transactions.pop();
            }
            
            loadTransactions();
        }

        function depositTON() {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Wallet
            const amount = 10; // –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
            
            gameData.currencies.ton += amount;
            addTransaction('–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ TON', amount, 'TON');
            
            updateBalances();
            saveGame();
            
            alert(`–ë–∞–ª–∞–Ω—Å TON –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amount} TON!`);
        }

        function depositUSDT() {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Wallet
            const amount = 50; // –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
            
            gameData.currencies.usdt += amount;
            addTransaction('–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ USDT', amount, 'USDT');
            
            updateBalances();
            saveGame();
            
            alert(`–ë–∞–ª–∞–Ω—Å USDT –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amount} USDT!`);
        }

        function withdrawTON() {
            if (gameData.currencies.ton <= 0) {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON –¥–ª—è –≤—ã–≤–æ–¥–∞!');
                return;
            }
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Wallet
            const amount = Math.min(5, gameData.currencies.ton); // –¢–µ—Å—Ç–æ–≤—ã–π –≤—ã–≤–æ–¥
            
            gameData.currencies.ton -= amount;
            addTransaction('–í—ã–≤–æ–¥ TON', -amount, 'TON');
            
            updateBalances();
            saveGame();
            
            alert(`–í—ã–≤–µ–¥–µ–Ω–æ ${amount} TON –Ω–∞ –≤–∞—à –∫–æ—à–µ–ª–µ–∫!`);
        }

        function withdrawUSDT() {
            if (gameData.currencies.usdt <= 0) {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ USDT –¥–ª—è –≤—ã–≤–æ–¥–∞!');
                return;
            }
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Wallet
            const amount = Math.min(25, gameData.currencies.usdt); // –¢–µ—Å—Ç–æ–≤—ã–π –≤—ã–≤–æ–¥
            
            gameData.currencies.usdt -= amount;
            addTransaction('–í—ã–≤–æ–¥ USDT', -amount, 'USDT');
            
            updateBalances();
            saveGame();
            
            alert(`–í—ã–≤–µ–¥–µ–Ω–æ ${amount} USDT –Ω–∞ –≤–∞—à –∫–æ—à–µ–ª–µ–∫!`);
        }

        // –§—É–Ω–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏
        function saveGame() {
            try {
                localStorage.setItem('hamsterCombatSave', JSON.stringify(gameData));
                console.log('–ò–≥—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞');
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏–≥—Ä—ã:', e);
            }
        }

        function loadGame() {
            try {
                const savedData = localStorage.getItem('hamsterCombatSave');
                if (savedData) {
                    gameData = JSON.parse(savedData);
                    updateBalances();
                    alert('–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!');
                } else {
                    alert('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!');
                }
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–≥—Ä—ã:', e);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!');
            }
        }

        function resetGame() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
                try {
                    localStorage.removeItem('hamsterCombatSave');
                    location.reload();
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±—Ä–æ—Å–µ –∏–≥—Ä—ã:', e);
                }
            }
        }

        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(() => {
            if (gameData.settings.autosave) {
                saveGame();
            }
        }, 30000);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            loadGame();
            updateBalances();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—É—â–µ–Ω–æ –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Telegram
            if (tg) {
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Web App
                tg.MainButton.setText('–ò–≥—Ä–∞—Ç—å –≤ –•–∞–º–µ—Å—Ç–µ—Ä –ö–æ–º–±–∞—Ç');
                tg.MainButton.show();
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
                tg.MainButton.onClick(() => {
                    showScreen('battle-screen');
                });
            }
        };
    </script>
</body>
</html>
